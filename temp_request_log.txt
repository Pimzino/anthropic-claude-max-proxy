
          ],
          "additionalProperties": false
        }
      }
    ],
    "thinking": {
      "type": "enabled",
      "budget_tokens": 32000
    }
  }
> 2025-10-30 11:47:16,612 - proxy - DEBUG - [786cbba7] Initiating streaming request (OpenAI format)
> 2025-10-30 11:47:16,614 - anthropic - DEBUG - [786cbba7] Adding interleaved-thinking beta (thinking enabled)
> 2025-10-30 11:47:16,615 - anthropic - DEBUG - [786cbba7] Final beta headers: oauth-2025-04-20,interleaved-thinking-2025-05-14
  2025-10-30 11:47:16,697 - proxy - INFO - POST /v1/chat/completions - 200 - 5.277s
  2025-10-30 11:47:16,698 - httpcore.connection - DEBUG - connect_tcp.started host='api.anthropic.com' port=443 local_address=None timeout=10.0 socket_options=None
  2025-10-30 11:47:16,958 - httpcore.connection - DEBUG - connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7bc0f4331ac0>
  2025-10-30 11:47:16,959 - httpcore.connection - DEBUG - start_tls.started ssl_context=<ssl.SSLContext object at 0x7bc0f417c1d0> server_hostname='api.anthropic.com' timeout=10.0
  2025-10-30 11:47:16,972 - httpcore.connection - DEBUG - start_tls.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x7bc0f41983e0>
  2025-10-30 11:47:16,973 - httpcore.http11 - DEBUG - send_request_headers.started request=<Request [b'POST']>
  2025-10-30 11:47:16,974 - httpcore.http11 - DEBUG - send_request_headers.complete
  2025-10-30 11:47:16,974 - httpcore.http11 - DEBUG - send_request_body.started request=<Request [b'POST']>
  2025-10-30 11:47:16,974 - httpcore.http11 - DEBUG - send_request_body.complete
  2025-10-30 11:47:16,975 - httpcore.http11 - DEBUG - receive_response_headers.started request=<Request [b'POST']>
  2025-10-30 11:47:17,300 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 400, b'Bad Request', [(b'Date', b'Thu, 30 Oct 2025 10:47:17 GMT'), (b'Content-Type', b'application/json'), (b'Content-Length', b'574'), (b'Connection', b'keep-alive'), (b'CF-RAY', b'996a556b1e71d9d6-FRA'), (b'x-should-retry', b'false'), (b'request-id', b'req_011CUdFTJbrY2th4gSgANVqE'), (b'strict-transport-security', b'max-age=31536000; includeSubDomains; preload'), (b'anthropic-organization-id', b'26fe3b51-6d57-4333-8412-a26d62915a0a'), (b'x-envoy-upstream-service-time', b'206'), (b'cf-cache-status', b'DYNAMIC'), (b'X-Robots-Tag', b'none'), (b'Server', b'cloudflare')])
  2025-10-30 11:47:17,300 - httpx - INFO - HTTP Request: POST https://api.anthropic.com/v1/messages "HTTP/1.1 400 Bad Request"
  2025-10-30 11:47:17,301 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'POST']>
  2025-10-30 11:47:17,301 - httpcore.http11 - DEBUG - receive_response_body.complete
  2025-10-30 11:47:17,301 - httpcore.http11 - DEBUG - response_closed.started
  2025-10-30 11:47:17,301 - httpcore.http11 - DEBUG - response_closed.complete
> 2025-10-30 11:47:17,302 - anthropic - ERROR - [786cbba7] Anthropic API error 400: {"type":"error","error":{"type":"invalid_request_error","message":"messages.1.content.0.type: Expected `thinking` or `redacted_thinking`, but found `text`. When `thinking` is enabled, a final `assistant` message must start with a thinking block (preceeding the lastmost set of `tool_use` and `tool_result` blocks). We recommend you include thinking blocks from previous turns. To avoid this requirement, disable `thinking`. Please consult our documentation at https://docs.claude.com/en/docs/build-with-claude/extended-thinking"},"request_id":"req_011CUdFTJbrY2th4gSgANVqE"}
  2025-10-30 11:47:17,303 - httpcore.connection - DEBUG - close.started
  2025-10-30 11:47:17,304 - httpcore.connection - DEBUG - close.complete

